<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: hooks/useSimonGame.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: hooks/useSimonGame.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { useState, useEffect } from "react";
import { useGameStore } from "../store/gameStore";

/**
 * Custom React hook that manages the core logic of the Simon Game.
 *
 * Handles:
 * - Sequence generation
 * - User input validation
 * - Difficulty scaling
 * - Level progression
 * - Game reset logic
 *
 * @hook
 * @returns {Object} Game state and control functions
 * @returns {string[]} returns.sequence Current generated color sequence
 * @returns {number} returns.level Current game level
 * @returns {boolean} returns.isGameOver Indicates if the game has ended
 * @returns {boolean} returns.isShowingSequence Indicates if the sequence is currently being displayed
 * @returns {string|null} returns.activeColor Currently highlighted color
 * @returns {Function} returns.handleUserClick Handles user input
 * @returns {Function} returns.addStep Adds new steps to the sequence
 * @returns {Function} returns.resetGame Resets the game state
 */
export const useSimonGame = () => {
    const { settings } = useGameStore();

    /** @type {[string[], Function]} */
    const [sequence, setSequence] = useState([]);

    /** @type {[string[], Function]} */
    const [userSequence, setUserSequence] = useState([]);

    /** @type {[number, Function]} */
    const [level, setLevel] = useState(1);

    /** @type {[boolean, Function]} */
    const [isGameOver, setIsGameOver] = useState(false);

    /** @type {[boolean, Function]} */
    const [isShowingSequence, setIsShowingSequence] = useState(false);

    /** @type {[string|null, Function]} */
    const [activeColor, setActiveColor] = useState(null);

    /**
     * Base available colors in the game.
     * @type {string[]}
     */
    const baseColors = ["red", "blue", "green", "yellow", "orange", "purple"];

    /**
     * Active colors depending on user settings.
     * @type {string[]}
     */
    const colors = baseColors.slice(0, settings.colorsCount);

    /**
     * Difficulty speed multiplier.
     * @type {number}
     */
    const difficultyMultiplier =
        settings.difficulty === "hard"
            ? 0.6
            : settings.difficulty === "medium"
                ? 0.8
                : 1;

    /**
     * Utility delay function.
     * @param {number} ms Delay in milliseconds
     * @returns {Promise&lt;void>}
     */
    const delay = (ms) => new Promise((res) => setTimeout(res, ms));

    /**
     * Plays the current color sequence visually.
     * Activates each color sequentially.
     * @returns {Promise&lt;void>}
     */
    const playSequence = async () => {
        setIsShowingSequence(true);
        for (let i = 0; i &lt; sequence.length; i++) {
            const color = sequence[i];
            setActiveColor(color);
            await delay(settings.speed * difficultyMultiplier);
            setActiveColor(null);
            await delay(300);
        }
        setIsShowingSequence(false);
    };

    /**
     * Adds one or more random steps to the sequence.
     * @param {number} [steps=1] Number of steps to add
     */
    const addStep = (steps = 1) => {
        setSequence((prev) => {
            const newSteps = Array.from({ length: steps }, () => {
                const randomColor =
                    colors[Math.floor(Math.random() * colors.length)];
                return randomColor;
            });
            return [...prev, ...newSteps];
        });
    };

    /**
     * Handles user click on a color pad.
     * Validates user input against the generated sequence.
     *
     * @param {string} color Selected color
     */
    const handleUserClick = (color) => {
        if (isShowingSequence || isGameOver) return;

        const newSequence = [...userSequence, color];
        setUserSequence(newSequence);

        for (let i = 0; i &lt; newSequence.length; i++) {
            if (newSequence[i] !== sequence[i]) {
                setIsGameOver(true);
                return;
            }
        }

        if (newSequence.length === sequence.length) {
            setLevel((l) => l + 1);
            setUserSequence([]);
            addStep(settings.difficulty === "hard" ? 2 : 1);
        }
    };

    /**
     * Resets the entire game state to initial values.
     */
    const resetGame = () => {
        setSequence([]);
        setUserSequence([]);
        setLevel(1);
        setIsGameOver(false);
        setActiveColor(null);
        addStep(1);
    };

    /**
     * Automatically plays sequence when it changes.
     */
    useEffect(() => {
        if (sequence.length > 0 &amp;&amp; !isShowingSequence) {
            playSequence();
        }
    }, [sequence]);

    return {
        sequence,
        level,
        isGameOver,
        isShowingSequence,
        activeColor,
        handleUserClick,
        addStep,
        resetGame,
    };
};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#Stat">Stat</a></li><li><a href="global.html#addResult">addResult</a></li><li><a href="global.html#clearResults">clearResults</a></li><li><a href="global.html#createResultsSlice">createResultsSlice</a></li><li><a href="global.html#results">results</a></li><li><a href="global.html#useSimonGame">useSimonGame</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Sat Feb 28 2026 11:53:54 GMT+0100 (за центральноєвропейським стандартним часом)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
